---
title: "Conformal Prediction Intervals"
output: html_notebook
date: "2021-04-01"
---



<p>There is a <a href="https://robjhyndman.com/hyndsight/intervals/">difference</a> between prediction and confidence intervals.</p>
<div id="prediction-interval-in-general" class="section level1">
<h1>Prediction interval in general</h1>
<ul>
<li>interval associated with a random variable that will be observed in future and the specific probability of the random variable being situated in this interval</li>
</ul>
<p>Prediction interval for <strong>new</strong> response:
<span class="math display">\[
    \hat y_h \pm t_{(1-\alpha/2, n-2)} \cdot SE_{pred}
\]</span></p>
<p><span class="math display">\[
    SE_{pred} = \sqrt{MSE \cdot \left(1+\frac{1}{n}+\frac{(x_h - \bar x)^2}{\sum(x_i - \bar x)^2}\right)}
\]</span></p>
<p>Prediction interval always narrower due to “extra MSE” term.</p>
</div>
<div id="confidence-interval-in-general" class="section level1">
<h1>Confidence interval in general</h1>
<ul>
<li>frequentist concept concerned with the position of the non-random, but unknown parameter in relation to the interval (“containing the true parameter with some probability, given a large number of repeated samples”)</li>
</ul>
<p>Confidence interval for <strong>mean</strong> response:</p>
<p><span class="math display">\[
        \hat y_h \pm t_{(1-\alpha/2, n-2)} \cdot SE_{fit}
\]</span></p>
<p><span class="math display">\[
        SE_{fit} = \sqrt{MSE \cdot \left(\frac{1}{n}+\frac{(x_h - \bar x)^2}{\sum(x_i - \bar x)^2}\right)}
\]</span></p>
<p><span class="math inline">\(SE_{fit}\)</span> can approach zero 0 due to missing “extra MSE” term.</p>
</div>
<div id="bayesian-credible-interval" class="section level1">
<h1>Bayesian credible interval</h1>
<ul>
<li>interval associated with the posterior distribution of a parameter (parameters are random variables in Bayesian perspective). Similarity to prediction interval, but here the interval is concerned with a parameter value in contrast to the association with an observation when talking about prediction intervals.</li>
</ul>
</div>
<div id="conformal-prediction-framework" class="section level1">
<h1>Conformal prediction framework</h1>
<ul>
<li><p><a href="https://jmlr.org/papers/v9/shafer08a.html">Vovk et al. 2008</a>, more thorough treatment in <a href="https://link.springer.com/book/10.1007/b106715">‘Algorithmic Learning in a Random World’ by Vovk et al. (2005)</a>.</p></li>
<li><p>Why? Validity of prediction intervals. The probability of excluding the correct target value is bounded by a predefined confidence level. It makes it possible to assess the uncertainty of each single prediction.</p></li>
</ul>
</div>
<div id="regression-conformal-prediction-intervals" class="section level1">
<h1>Regression conformal prediction intervals</h1>
<ul>
<li><a href="https://link.springer.com/article/10.1007/s10994-014-5453-0">Johansson et al. 2014</a></li>
</ul>
<div id="inductive-conformal-prediction" class="section level2">
<h2>Inductive conformal prediction</h2>
<p>Try executing this chunk by clicking the <em>Run</em> button within the chunk or by placing your cursor inside it and pressing <em>Cmd+Shift+Enter</em>.</p>
<pre class="r"><code>plot(cars)</code></pre>
<p><img src="/posts/test_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>Add a new chunk by clicking the <em>Insert Chunk</em> button on the toolbar or by pressing <em>Cmd+Option+I</em>.</p>
<p>When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the <em>Preview</em> button or press <em>Cmd+Shift+K</em> to preview the HTML file).</p>
<p>The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike <em>Knit</em>, <em>Preview</em> does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.</p>
</div>
</div>
